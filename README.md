# (IEEE TIFS) Attention-Based API Locating for Malware Techniques

This paper presents APILI, an innovative approach
to behavior-based malware analysis that utilizes deep learning
to locate the API calls corresponding to discovered malware
techniques in dynamic execution traces. APILI defines mul-
tiple attentions between API calls, resources, and techniques,
incorporating MITRE ATT&CK framework, adversary tactics,
techniques and procedures, through a neural network. We employ
fine-tuned BERT for arguments/resources embedding, SVD for
technique representation, and several design enhancements, in-
cluding layer structure and noise addition, to improve the locating
performance. To the best of our knowledge, this is the first
attempt to locate low-level API calls that correspond to high-
level malicious behaviors (that is, techniques). Our evaluation
demonstrates that APILI outperforms other traditional and
machine learning techniques in both technique discovery and
API locating. These results indicate the promising performance
of APILI, thus allowing it to reduce the analysis workload.

## Prediction:
1. Get the trace(report) file (.json) from Cuckoo Sandbox.
2. Make mist file via OperaPrediction/make_mist_ver_cuckoo_fixed.ipynb
3. Prediction via OperaPrediction/Predict.ipynb

## Training from sketch
Download Dataset /training code / ckp / result in paper 
https://1drv.ms/f/s!AmHd3ERrMbP0xdlAh4_FqMT-Uxs8Qg?e=rDiLxv


## Update

Done:
1. Upload dataset.csv in "Dataset" folder
2. Upload OPERA.mist file (OperaSetup_win7.mist) in "OperaPrediction" folder, which is recorded by Cuckoo sandbox and transfer json file in to mist file.
3. Upload inference OPERA file in "OperaPrediction" folder, which inclued load BERT, Autoencoder and APILI weights, and predict technique of OPERA.mist file. OPERA is out-of-list in our training dataset. (Predict.ipynb)
4. Upload Autoencoder weight in "AutoEncoder" folder. (ep_162_AE_loss_0.436_val_0.459)
5. Upload Mitre Representation files in "MitreRepresentation" folder.
6. Upload Mitre other files in "Tools" folder.
7. Upload Model check point in "CKP" folder. (epoch_175_L_0.437_P_0.936_R_0.949_F0.942)
8. Upload locating example code for Table X(Noise layer 1), this code could change noise layer from 0 to 2 to reproduce result of Table X
